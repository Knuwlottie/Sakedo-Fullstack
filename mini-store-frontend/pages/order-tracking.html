<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Theo Dõi Đơn Hàng - Sakedo</title>
    <link rel="stylesheet" href="../css/base/variables.css" />
    <link rel="stylesheet" href="../css/pages/global.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <style>
      .tracking-container {
        max-width: 800px;
        margin: 50px auto;
        padding: 20px;
      }
      .order-id-title {
        text-align: center;
        font-family: "Fruktur", cursive;
        font-size: 2rem;
        margin-bottom: 40px;
      }

      /* THANH TIẾN TRÌNH */
      .progress-track {
        display: flex;
        justify-content: space-between;
        position: relative;
        margin-bottom: 50px;
      }

      /* Đường kẻ xám chạy ngang */
      .progress-track::before {
        content: "";
        position: absolute;
        top: 15px;
        left: 0;
        width: 100%;
        height: 4px;
        background: #eee;
        z-index: -1;
      }

      .step {
        text-align: center;
        width: 25%;
        position: relative;
        opacity: 0.5; /* Mờ đi nếu chưa đến bước này */
        transition: 0.3s;
      }

      .step-icon {
        width: 35px;
        height: 35px;
        background: #fff;
        border: 3px solid #ccc;
        border-radius: 50%;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 10px;
        font-weight: bold;
        color: #ccc;
      }

      .step-text {
        font-weight: 600;
        font-size: 0.9rem;
      }

      /* TRẠNG THÁI ACTIVE (Đã hoàn thành hoặc đang xử lý) */
      .step.active {
        opacity: 1;
      }
      .step.active .step-icon {
        border-color: #28a745; /* Màu xanh lá */
        background: #28a745;
        color: #fff;
      }

      /* Đường kẻ xanh nối các bước active (Option nâng cao) */
      /* Cái này xử lý bằng JS để chỉnh width sẽ chuẩn hơn */

      .order-details {
        background: #f9f9f9;
        padding: 30px;
        border-radius: 15px;
        border: 1px dashed #aaa;
      }

      .btn-home {
        display: block;
        width: 100%;
        text-align: center;
        padding: 15px;
        background: #d8b26e;
        color: #fff;
        font-weight: bold;
        text-decoration: none;
        border-radius: 8px;
        margin-top: 30px;
      }
    </style>
  </head>
  <body>
    <div class="tracking-container">
      <h1 class="order-id-title">Đơn Hàng #<span id="display-id">...</span></h1>

      <div class="progress-track">
        <div class="step active" id="step-1">
          <div class="step-icon"><i class="fas fa-file-invoice"></i></div>
          <div class="step-text">Chờ xác nhận</div>
        </div>

        <div class="step" id="step-2">
          <div class="step-icon"><i class="fas fa-utensils"></i></div>
          <div class="step-text">Chờ lấy hàng</div>
        </div>

        <div class="step" id="step-3">
          <div class="step-icon"><i class="fas fa-motorcycle"></i></div>
          <div class="step-text">Đang giao</div>
        </div>

        <div class="step" id="step-4">
          <div class="step-icon"><i class="fas fa-check"></i></div>
          <div class="step-text">Đã nhận đơn</div>
        </div>
      </div>

      <div class="order-details">
        <h3>Chi tiết đơn hàng</h3>
        <p>
          <strong>Người nhận:</strong> <span id="track-name">Đang tải...</span>
        </p>
        <p>
          <strong>Tổng tiền:</strong>
          <span id="track-total" style="color: #d32f2f; font-weight: bold"
            >...</span
          >
        </p>
        <p>
          <strong>Tài xế:</strong>
          <span id="track-driver">Chưa có tài xế nhận đơn</span>
        </p>
      </div>

      <a href="/index.html" class="btn-home">Quay về trang chủ</a>
    </div>

    <script>
      // MÔ PHỎNG LOGIC LẤY TRẠNG THÁI TỪ BACKEND
      document.addEventListener("DOMContentLoaded", function () {
        // 1. Lấy ID từ URL
        const params = new URLSearchParams(window.location.search);
        const orderId = params.get("id") || "ORD-001"; // Demo ID
        document.getElementById("display-id").textContent = orderId;

        // 2. GỌI API LẤY TRẠNG THÁI ĐƠN HÀNG
        // fetch(`/api/orders/${orderId}`)...
        // Giả sử Backend trả về status = 3 (Đang giao)
        const currentStatus = 3;

        // 3. Cập nhật giao diện theo status
        updateTrackingUI(currentStatus);
      });

      function updateTrackingUI(statusLevel) {
        // statusLevel: 1=Chờ xác nhận, 2=Chờ lấy, 3=Đang giao, 4=Hoàn thành
        for (let i = 1; i <= 4; i++) {
          const step = document.getElementById(`step-${i}`);
          if (i <= statusLevel) {
            step.classList.add("active"); // Sáng đèn
          } else {
            step.classList.remove("active"); // Tối đèn
          }
        }

        // Nếu đang giao (Level 3) -> Hiển thị tên tài xế
        if (statusLevel >= 3) {
          document.getElementById(
            "track-driver"
          ).innerHTML = `<i class="fas fa-user-check"></i> Nguyễn Văn Tài Xế - 0909.888.xxx`;
        }
      }
    </script>
  </body>
</html>
